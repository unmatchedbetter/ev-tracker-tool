<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Football Odds Comparison</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f7f7f7;
    }
    h1 {
      text-align: center;
    }
    input {
      padding: 8px;
      width: 200px;
      margin-bottom: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: center;
    }
    th {
      background: #333;
      color: white;
    }
    tr:nth-child(even) {
      background: #f2f2f2;
    }
  </style>
</head>
<body>
  <h1>Football Odds Search (Exact Match)</h1>
  <input type="number" id="searchOdds" placeholder="Enter odds (e.g. 2.0)" step="0.01" />
  <table>
    <thead>
      <tr>
        <th>Time</th>
        <th>Match</th>
        <th>League</th>
        <th>Bookmaker</th>
        <th>Market</th>
        <th>Outcome</th>
        <th>Odds</th>
      </tr>
    </thead>
    <tbody id="oddsTable"></tbody>
  </table>

  <script>
    const API_KEY = '7063cef5a5dccafa3a0d4ddc90f7463b';
    const searchInput = document.getElementById('searchOdds');
    const tableBody = document.getElementById('oddsTable');

    async function fetchOdds() {
      const url = `https://api.the-odds-api.com/v4/sports/soccer_epl/odds/?apiKey=${API_KEY}&regions=uk&markets=h2h,draw_no_bet&oddsFormat=decimal`;

      try {
        const res = await fetch(url);
        const data = await res.json();
        renderOdds(data);
      } catch (error) {
        console.error("Error fetching odds:", error);
      }
    }

    function renderOdds(data) {
      tableBody.innerHTML = '';
      const target = parseFloat(searchInput.value);

      const rows = [];

      data.forEach(match => {
        const time = new Date(match.commence_time).toLocaleString();
        const teams = `${match.home_team} vs ${match.away_team}`;
        const league = match.sport_title;

        match.bookmakers.forEach(bookmaker => {
          bookmaker.markets.forEach(market => {
            market.outcomes.forEach(outcome => {
              const odds = parseFloat(outcome.price);
              if (odds === target) {
                rows.push({
                  time,
                  teams,
                  league,
                  bookmaker: bookmaker.title,
                  market: market.key,
                  outcome: outcome.name,
                  odds
                });
              }
            });
          });
        });
      });

      // Sort by time
      rows.sort((a, b) => new Date(a.time) - new Date(b.time));

      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${row.time}</td>
          <td>${row.teams}</td>
          <td>${row.league}</td>
          <td>${row.bookmaker}</td>
          <td>${row.market}</td>
          <td>${row.outcome}</td>
          <td>${row.odds}</td>
        `;
        tableBody.appendChild(tr);
      });
    }

    searchInput.addEventListener('input', fetchOdds);
  </script>
</body>
</html>
